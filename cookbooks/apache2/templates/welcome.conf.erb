#
# This configuration file enables the default "Welcome" page if there
# is no default index page present for the root URL.  To disable the
# Welcome page, comment out all the lines below.
#
# NOTE: if this file is removed, it will be restored on upgrades.
#

DocumentRoot "<%= @docroot_dir %>"

# Further relax access to the default document root:
<Directory "<%= @docroot_dir %>">
    #
    # Possible values for the Options directive are "None", "All",
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that "MultiViews" must be named *explicitly* --- "Options All"
    # doesn't give it to you.
    #
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be "All", "None", or any combination of the keywords:
    #   Options FileInfo AuthConfig Limit
    #
    AllowOverride None

    #
    # Controls who can get stuff from this server.
    #
    Require all granted
</Directory>

<LocationMatch "^/+$">
    Options -Indexes
    ErrorDocument 403 /.noindex.html
</LocationMatch>

<Directory /usr/share/httpd/noindex>
    AllowOverride None
    Require all granted
</Directory>

<% if node['platform_version'].to_i == 8 -%>
Alias /.noindex.html /usr/share/httpd/noindex/index.html.en-US
Alias /noindex/css/bootstrap.min.css /usr/share/httpd/noindex/common/css/bootstrap.min.css
Alias /noindex/css/open-sans.css /usr/share/httpd/noindex/common/css/styles.css
Alias /noindex/common/images/pb-apache.png /usr/share/httpd/noindex/common/images/pb-apache.png
Alias /noindex/common/images/pb-centos.png /usr/share/httpd/noindex/common/images/pb-centos.png
<% else -%>
Alias /.noindex.html /usr/share/httpd/noindex/index.html
Alias /noindex/css/bootstrap.min.css /usr/share/httpd/noindex/css/bootstrap.min.css
Alias /noindex/css/open-sans.css /usr/share/httpd/noindex/css/open-sans.css
Alias /images/apache_pb.gif /usr/share/httpd/noindex/images/apache_pb.gif
Alias /images/poweredby.png /usr/share/httpd/noindex/images/poweredby.png
<% end -%>
