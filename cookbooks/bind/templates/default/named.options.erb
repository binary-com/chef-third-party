# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.

<% unless @acls.nil? || @acls.empty? -%>
<% @acls.each do |acl| -%>
acl "<%= acl.name -%>" {
  <% acl.entries.each do |entry| -%>
  <%= entry -%>;
  <% end -%>
};
<% end -%>

<% end -%>
options {
  directory "<%= @vardir %>";
  dump-file "data/cache_dump.db";
  statistics-file "data/named_stats.txt";
  memstatistics-file "data/named_mem_stats.txt";
  <% if @ipv6_listen -%>
  listen-on-v6 { any; };
  <% end -%>
  <% if @pid_file -%>
  pid-file "<%= @pid_file %>";
  <% end -%>
  <% if @session_keyfile -%>
  session-keyfile "<%= @session_keyfile %>";
  <% end -%>
  <% unless @options.empty? %>
  <% @options.each do |option_line| -%>
  <%= option_line %>;
  <% end -%>
  <% end -%>
};
<% unless @logging_channels.empty? %>

logging {
  <% @logging_channels.each do |channel| -%>
  channel <%= channel.name %> {
    <%= channel.destination %>;
    severity <%= channel.severity %>;
    <% if channel.print_category -%>
    print-category <%= channel.print_category ? 'yes' : 'no' %>;
    <% end %>
    <% if channel.print_severity -%>
    print-severity <%= channel.print_severity ? 'yes' : 'no' %>;
    <% end %>
    <% if channel.print_time -%>
    print-time <%= channel.print_time ? 'yes' : 'no' %>;
    <% end %>
    <% channel.options.each do |option_line| -%>
    <%= option_line %>;
    <% end -%>
  };

  <% end -%>
  <% @logging_categories.each do |category| -%>
  category <%= category.name %> { <%= category.channels.map { |channel| channel + ';' }.join(' ') %> };
  <% end -%>
};
<% end %>
<% if @statistics_channel %>

statistics-channels {
  <% @statistics_channel.each do |channel| %>
  inet <%= channel[:address] %> port <%= channel[:port] -%><% if channel[:allow] -%> allow { <%= channel[:allow] %>; }<% end -%>;
  <% end %>
};
<% end %>
<% unless @controls.empty? -%>

controls {
  <% @controls.each do |control| -%>
<%= control %>;
<% end -%>
};
<% end -%>
